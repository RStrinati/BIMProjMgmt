[2025-06-11 14:29:16] [SKIP] activities_admin_activities: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_assets_activities: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_bridge_activities: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_cost_activities: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_cost_changes: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_docs_activities: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_docs_custom_attribute_constraints: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_docs_custom_attributes: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_docs_naming_standards: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_docs_permissions: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_docs_standard_attributes: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_issues_activities: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_issues_changes: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_rfis_activities: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_rfis_changes: missing merge SQL
[2025-06-11 14:29:16] [SKIP] activities_sheets_activities: missing merge SQL
[2025-06-11 14:29:17] [SKIP] activities_submittals_activities: missing merge SQL
[2025-06-11 14:29:17] [SKIP] activities_submittals_object_ball_in_court_companies: missing merge SQL
[2025-06-11 14:29:17] [SKIP] activities_submittals_object_ball_in_court_roles: missing merge SQL
[2025-06-11 14:29:17] [SKIP] activities_submittals_object_ball_in_court_users: missing merge SQL
[2025-06-11 14:29:17] [SKIP] activities_submittals_target_ball_in_court_companies: missing merge SQL
[2025-06-11 14:29:17] [SKIP] activities_submittals_target_ball_in_court_roles: missing merge SQL
[2025-06-11 14:29:17] [SKIP] activities_submittals_target_ball_in_court_users: missing merge SQL
[2025-06-11 14:29:17] [SKIP] activities_submittals_target_steps: missing merge SQL
[2025-06-11 14:29:17] [SKIP] activities_submittals_target_tasks: missing merge SQL
[2025-06-11 14:29:17] [SKIP] activities_submittals_target_transition_attachments: missing merge SQL
[2025-06-11 14:29:17] [SKIP] activities_submittals_target_watchers: missing merge SQL
[2025-06-11 14:29:17] [SKIP] admin_account_services: missing merge SQL
[2025-06-11 14:29:17] [SKIP] admin_accounts: missing merge SQL
[2025-06-11 14:29:17] [SKIP] admin_business_units: missing merge SQL
[2025-06-11 14:29:17] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_companies.csv → staging.admin_companies ...
[2025-06-11 14:29:17] [DEBUG] First insert into staging.admin_companies: ('82c43acb-6369-4c53-8132-57d5e7f04b98', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'School Infrastructure NSW', 'Owner', 'owner', 'Level 8 West', '8 Central Ave', 'Eveleigh', 'NSW', 2015, 'AU', '+61 (13) 0048 2651', 'https://www.schoolinfrastructure.nsw.gov.au/', None, None, None, None, '2022-01-18 17:05:55.815', 122, 71, None)
[2025-06-11 14:29:17] [DONE] Processed admin_companies in 0.27s
[2025-06-11 14:29:17] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_project_companies.csv → staging.admin_project_companies ...
[2025-06-11 14:29:17] [DEBUG] First insert into staging.admin_project_companies: ('e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', '82c43acb-6369-4c53-8132-57d5e7f04b98', '7a870e2e-a4c3-4733-988b-7d7680564de6', 252229688)
[2025-06-11 14:29:17] [DONE] Processed admin_project_companies in 0.21s
[2025-06-11 14:29:17] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_project_products.csv → staging.admin_project_products ...
[2025-06-11 14:29:17] [DEBUG] First insert into staging.admin_project_products: ('e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'autoSpecs', 'active', '2023-03-06 21:30:10.935')
[2025-06-11 14:29:17] [DONE] Processed admin_project_products in 0.21s
[2025-06-11 14:29:17] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_project_roles.csv → staging.admin_project_roles ...
[2025-06-11 14:29:17] [DEBUG] First insert into staging.admin_project_roles: ('7a870e2e-a4c3-4733-988b-7d7680564de6', 'e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', 252229695, 'BIM Manager', 'inactive')
[2025-06-11 14:29:17] [DONE] Processed admin_project_roles in 0.2s
[2025-06-11 14:29:17] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_project_services.csv → staging.admin_project_services ...
[2025-06-11 14:29:18] [DONE] Processed admin_project_services in 0.03s
[2025-06-11 14:29:18] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_project_user_companies.csv → staging.admin_project_user_companies ...
[2025-06-11 14:29:18] [DEBUG] First insert into staging.admin_project_user_companies: ('7a870e2e-a4c3-4733-988b-7d7680564de6', '82c43acb-6369-4c53-8132-57d5e7f04b98', 'e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', '11ec3d54-bcd8-46bc-86fc-f440b61f201f')
[2025-06-11 14:29:18] [DONE] Processed admin_project_user_companies in 0.21s
[2025-06-11 14:29:18] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_project_user_products.csv → staging.admin_project_user_products ...
[2025-06-11 14:29:18] [DEBUG] First insert into staging.admin_project_user_products: ('e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', '7a870e2e-a4c3-4733-988b-7d7680564de6', '01d2be7e-bc1b-41a8-81be-0c5ae7f4a6f6', 'docs', 'project_user', '2025-03-12 23:13:10.702')
[2025-06-11 14:29:18] [DONE] Processed admin_project_user_products in 0.27s
[2025-06-11 14:29:18] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_project_user_roles.csv → staging.admin_project_user_roles ...
[2025-06-11 14:29:18] [DEBUG] First insert into staging.admin_project_user_roles: ('e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', '7a870e2e-a4c3-4733-988b-7d7680564de6', '11ec3d54-bcd8-46bc-86fc-f440b61f201f', '294ad8d9-4cd9-401c-b3eb-b4f5caea97d8', '2023-03-06 21:30:15.443')
[2025-06-11 14:29:18] [DONE] Processed admin_project_user_roles in 0.21s
[2025-06-11 14:29:18] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_project_user_services.csv → staging.admin_project_user_services ...
[2025-06-11 14:29:18] [DONE] Processed admin_project_user_services in 0.03s
[2025-06-11 14:29:18] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_project_users.csv → staging.admin_project_users ...
[2025-06-11 14:29:18] [DEBUG] First insert into staging.admin_project_users: ('e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', '7a870e2e-a4c3-4733-988b-7d7680564de6', '11ec3d54-bcd8-46bc-86fc-f440b61f201f', 'active', '82c43acb-6369-4c53-8132-57d5e7f04b98', 'project_admin', '2023-03-06 21:30:15.443', '2023-03-06 21:32:15.334')
[2025-06-11 14:29:18] [FAIL] C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_project_users.csv import failed: ('String data, right truncation: length 52 buffer 46', 'HY000')
[2025-06-11 14:29:18] [DONE] Processed admin_project_users in 0.05s
[2025-06-11 14:29:18] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_projects.csv → staging.admin_projects ...
[2025-06-11 14:29:18] [DEBUG] First insert into staging.admin_projects: ('e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'Schofields PS [P220702]', None, None, 'Education Facility', 0, 'AUD', 'active', 'P220702', '60 St Albans Rd', None, 'Schofields', 'NSW', 2762, 'AU', 'Australia/Sydney', None, None, None, None, '2023-03-06 21:30:10.914', 1, -33.692506, 150.874863, '2023-04-04 01:27:38.683', None, 88, 18, 'production')
[2025-06-11 14:29:19] [DONE] Processed admin_projects in 0.22s
[2025-06-11 14:29:19] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_roles.csv → staging.admin_roles ...
[2025-06-11 14:29:19] [DEBUG] First insert into staging.admin_roles: ('6f09b26b-feed-4806-b7f5-67b89f1fb9db', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'Landscape', 'active')
[2025-06-11 14:29:19] [DONE] Processed admin_roles in 0.21s
[2025-06-11 14:29:19] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_users.csv → staging.admin_users ...
[2025-06-11 14:29:19] [DEBUG] First insert into staging.admin_users: ('11ec3d54-bcd8-46bc-86fc-f440b61f201f', 'ZUNJU76VMXUAJLQP', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'craig.walker34@det.nsw.edu.au', 'Craig Walker', 'Craig', 'Walker', None, None, None, None, None, 'US', datetime.datetime(2023, 6, 9, 3, 6, 41), '61499893641', None, 1, 1, 1, 1, '4ed9cf1b-4e36-40cf-8971-c4bc10164c7c', '82c43acb-6369-4c53-8132-57d5e7f04b98', 'active', None, '2022-08-17 01:16:59.991', '2024-02-16 03:09:08.907')
[2025-06-11 14:29:19] [FAIL] C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\admin_users.csv import failed: ('String data, right truncation: length 52 buffer 46', 'HY000')
[2025-06-11 14:29:19] [DONE] Processed admin_users in 0.08s
[2025-06-11 14:29:19] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\clashes_assigned_clash_group.csv → staging.clashes_assigned_clash_group ...
[2025-06-11 14:29:19] [DEBUG] First insert into staging.clashes_assigned_clash_group: ('7924d700-04f9-11ef-8e21-0b4b01ef9c4a', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', 'e5d0a89d-5711-4730-824f-f46e5439e296', 'STRU (gr flr slab & steel framing) vs Combined Services (duct & pipes)', '56 total clashes:\n\n19 clashes between Floor [1444973] in SPS-STN-BQ-ZZ-M3-S-0001.rvt - 3D View - Coord - Structural and SPS-BSE-BQ-ZZ-M3-N-0001.rvt - 3D - BIM 360 Glue\n\n1 clash between Foundation - Strc - Pad - 0200 [1498965] in SPS-STN-BQ-ZZ-M3-S-0001.rvt - 3D View - Coord - Structural and SPS-BSE-BQ-ZZ-M3-N-0001.rvt - 3D - BIM 360 Glue\n\n2 clashes between Framing - Strc - Steel - EA - 0200 [1610535] in SPS-STN-BQ-ZZ-M3-S-0001.rvt - 3D View - Coord - Structural and SPS-BSE-BQ-ZZ-M3-N-0001.rvt - 3D - BIM 360 Glue\n\n2 clashes between Framing - Strc - Steel - UB - 0200 [1450100] in SPS-STN-BQ-ZZ-M3-S-0001.rvt - 3D View - Coord - Structural and SPS-BSE-BQ-ZZ-M3-N-0001.rvt - 3D - BIM 360 Glue', 'open', 'f73efcee-fed8-4fd0-9713-b5f2a39c40ca', '3d1a718c-50c2-49cc-920c-93631c06e49a', 8, '2024-04-28 00:51:43.826328', 'A7T2C667MYFWBP7D')
[2025-06-11 14:29:19] [FAIL] C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\clashes_assigned_clash_group.csv import failed: ('String data, right truncation: length 52 buffer 46', 'HY000')
[2025-06-11 14:29:19] [DONE] Processed clashes_assigned_clash_group in 0.06s
[2025-06-11 14:29:19] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\clashes_clash_group_to_clash_id.csv → staging.clashes_clash_group_to_clash_id ...
[2025-06-11 14:29:19] [DEBUG] First insert into staging.clashes_clash_group_to_clash_id: ('5568c520-e027-11ee-99f2-fbd83b1c6276', 24738320978859, '7a870e2e-a4c3-4733-988b-7d7680564de6', 'e8c6b4fd-6e47-4d9c-815f-f871c5b30da7')
[2025-06-11 14:29:19] [DONE] Processed clashes_clash_group_to_clash_id in 0.39s
[2025-06-11 14:29:19] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\clashes_clash_test.csv → staging.clashes_clash_test ...
[2025-06-11 14:29:19] [DEBUG] First insert into staging.clashes_clash_test: ('1ddec57f-b2b1-45d3-970d-968b3ba0c2bc', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', '3d1a718c-50c2-49cc-920c-93631c06e49a', 1, 'urn:adsk.wipprod:fs.folder:co.uf78DfeATTumiv0XeUCnwA', '2024-03-10 02:43:25.773463', '2024-03-10 02:44:10.742921', 'Successful', 1)
[2025-06-11 14:29:20] [DONE] Processed clashes_clash_test in 0.21s
[2025-06-11 14:29:20] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\clashes_closed_clash_group.csv → staging.clashes_closed_clash_group ...
[2025-06-11 14:29:20] [DEBUG] First insert into staging.clashes_closed_clash_group: ('a3fd1d70-cfa2-11ee-aa84-83b624d86dcd', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', 'VALID_INTERFACE', '2 clashes across 2 Clash Groups', None, 'eee5af12-7225-4117-a197-0b4364b329d4', '51815074-4a51-4a50-8989-37a88be7e271', 9, '2024-02-20 03:46:40.671845', 'U466RCJNQ2CZ')
[2025-06-11 14:29:20] [FAIL] C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\clashes_closed_clash_group.csv import failed: ('String data, right truncation: length 52 buffer 46', 'HY000')
[2025-06-11 14:29:20] [DONE] Processed clashes_closed_clash_group in 0.22s
[2025-06-11 14:29:20] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\issues_attachments.csv → staging.issues_attachments ...
[2025-06-11 14:29:20] [SQL ERROR] in merge_issues_attachments.sql: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'updated_by'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'updated_by'. (207)")
-- MERGE for issues_attachments
WITH src_deduped AS (
    SELECT *, ROW_NUMBER() OVER (
        PARTITION BY attachment_id
        ORDER BY updated_at DESC
    ) AS rn
    FROM staging.issues_attachments
    WHERE attachment_id IS NOT NULL
)
MERGE INTO dbo.issues_attachments AS tgt
USING (SELECT * FROM src_deduped WHERE rn = 1) AS src
ON tgt.attachment_id = src.attachment_id
WHEN MATCHED THEN
    UPDATE SET
        issue_id = src.issue_id,
        attachment_name = src.attachment_name,
        attachment_type = src.attachment_type,
        created_by = src.created_by,
        created_at = src.created_at,
        updated_by = src.updated_by,
        updated_at = src.updated_at
WHEN NOT MATCHED THEN
    INSERT (attachment_id, issue_id, attachment_name, attachment_type, created_by, created_at, updated_by, updated_at)
    VALUES (src.attachment_id, src.issue_id, src.attachment_name, src.attachment_type, src.created_by, src.created_at, src.updated_by, src.updated_at);
[2025-06-11 14:29:20] [DONE] Processed issues_attachments in 0.03s
[2025-06-11 14:29:20] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\issues_checklist_mappings.csv → staging.issues_checklist_mappings ...
[2025-06-11 14:29:20] [DONE] Processed issues_checklist_mappings in 0.2s
[2025-06-11 14:29:20] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\issues_comments.csv → staging.issues_comments ...
[2025-06-11 14:29:20] [DEBUG] First insert into staging.issues_comments: ('3201c19d-965c-4d38-a1d5-1e8e870e103a', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', 'c149d06a-776d-4cac-9994-8e5e9617e024', 'Adjust base level of partitions', 'U466RCJNQ2CZ', '2024-02-20 05:22:19.651')
[2025-06-11 14:29:20] [DONE] Processed issues_comments in 0.06s
[2025-06-11 14:29:20] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\issues_custom_attribute_list_values.csv → staging.issues_custom_attribute_list_values ...
[2025-06-11 14:29:20] [SQL ERROR] in merge_issues_custom_attribute_list_values.sql: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'created_at'. (207) (SQLExecDirectW)")
-- MERGE for issues_custom_attribute_list_values
WITH src_deduped AS (
    SELECT *, ROW_NUMBER() OVER (
        PARTITION BY attribute_mappings_id
        ORDER BY created_at DESC
    ) AS rn
    FROM staging.issues_custom_attribute_list_values
    WHERE attribute_mappings_id IS NOT NULL
)
MERGE INTO dbo.issues_custom_attribute_list_values AS tgt
USING (SELECT * FROM src_deduped WHERE rn = 1) AS src
ON tgt.attribute_mappings_id = src.attribute_mappings_id
WHEN MATCHED THEN
    UPDATE SET
        list_id = src.list_id,
        list_value = src.list_value,
        created_at = src.created_at
WHEN NOT MATCHED THEN
    INSERT (attribute_mappings_id, list_id, list_value, created_at)
    VALUES (src.attribute_mappings_id, src.list_id, src.list_value, src.created_at);
[2025-06-11 14:29:20] [DONE] Processed issues_custom_attribute_list_values in 0.2s
[2025-06-11 14:29:20] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\issues_custom_attributes.csv → staging.issues_custom_attributes ...
[2025-06-11 14:29:20] [SQL ERROR] in merge_issues_custom_attributes.sql: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'created_at'. (207) (SQLExecDirectW)")
-- MERGE for issues_custom_attributes
WITH src_deduped AS (
    SELECT *, ROW_NUMBER() OVER (
        PARTITION BY issue_id
        ORDER BY created_at DESC
    ) AS rn
    FROM staging.issues_custom_attributes
    WHERE issue_id IS NOT NULL
)
MERGE INTO dbo.issues_custom_attributes AS tgt
USING (SELECT * FROM src_deduped WHERE rn = 1) AS src
ON tgt.issue_id = src.issue_id
WHEN MATCHED THEN
    UPDATE SET
        mapped_item_type = src.mapped_item_type,
        attribute_mapping_id = src.attribute_mapping_id,
        attribute_title = src.attribute_title,
        attribute_description = src.attribute_description,
        attribute_data_type = src.attribute_data_type,
        is_required = src.is_required,
        attribute_value = src.attribute_value
WHEN NOT MATCHED THEN
    INSERT (issue_id, mapped_item_type, attribute_mapping_id, attribute_title, attribute_description, attribute_data_type, is_required, attribute_value)
    VALUES (src.issue_id, src.mapped_item_type, src.attribute_mapping_id, src.attribute_title, src.attribute_description, src.attribute_data_type, src.is_required, src.attribute_value);
[2025-06-11 14:29:20] [DONE] Processed issues_custom_attributes in 0.03s
[2025-06-11 14:29:20] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\issues_custom_attributes_mappings.csv → staging.issues_custom_attributes_mappings ...
[2025-06-11 14:29:20] [SQL ERROR] in merge_issues_custom_attributes_mappings.sql: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Invalid column name 'created_at'. (207) (SQLExecDirectW)")
-- MERGE for issues_custom_attributes
WITH src_deduped AS (
    SELECT *, ROW_NUMBER() OVER (
        PARTITION BY issue_id
        ORDER BY created_at DESC
    ) AS rn
    FROM staging.issues_custom_attributes
    WHERE issue_id IS NOT NULL
)
MERGE INTO dbo.issues_custom_attributes AS tgt
USING (SELECT * FROM src_deduped WHERE rn = 1) AS src
ON tgt.issue_id = src.issue_id
WHEN MATCHED THEN
    UPDATE SET
        mapped_item_type = src.mapped_item_type,
        attribute_mapping_id = src.attribute_mapping_id,
        attribute_title = src.attribute_title,
        attribute_description = src.attribute_description,
        attribute_data_type = src.attribute_data_type,
        is_required = src.is_required,
        attribute_value = src.attribute_value
WHEN NOT MATCHED THEN
    INSERT (issue_id, mapped_item_type, attribute_mapping_id, attribute_title, attribute_description, attribute_data_type, is_required, attribute_value)
    VALUES (src.issue_id, src.mapped_item_type, src.attribute_mapping_id, src.attribute_title, src.attribute_description, src.attribute_data_type, src.is_required, src.attribute_value);
[2025-06-11 14:29:20] [DONE] Processed issues_custom_attributes_mappings in 0.19s
[2025-06-11 14:29:20] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\issues_issue_subtypes.csv → staging.issues_issue_subtypes ...
[2025-06-11 14:29:21] [DEBUG] First insert into staging.issues_issue_subtypes: ('f43a1aeb-228d-4243-a643-95992e11f52d', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', '6b2ea181-83eb-4b7c-9b73-609cb0dd3169', 'Quality', 1, 'System', '2023-03-06 21:30:28.304', 'System', '2023-03-06 21:30:28.304', None, None)
[2025-06-11 14:29:21] [DONE] Processed issues_issue_subtypes in 0.22s
[2025-06-11 14:29:21] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\issues_issue_types.csv → staging.issues_issue_types ...
[2025-06-11 14:29:21] [DEBUG] First insert into staging.issues_issue_types: ('6b2ea181-83eb-4b7c-9b73-609cb0dd3169', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', 'Quality', 1, 'System', '2023-03-06 21:30:28.301', 'System', '2023-03-06 21:30:28.301', None, None)
[2025-06-11 14:29:21] [DONE] Processed issues_issue_types in 0.05s
[2025-06-11 14:29:21] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\issues_issues.csv → staging.issues_issues ...
[2025-06-11 14:29:21] [DEBUG] First insert into staging.issues_issues: ('9a61718a-cffd-434f-8108-00b54238b822', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', 33, 'HYDR (pipes under gr) vs FIRE (pipes under gr)', '11 total clashes:\n\n3 clashes between Pipe Types [8751089] in SPS-BSE-PRM-ZZ-M3-N-0001.rvt - #3D - Workset - Hydraulic and SPS-BSE-PRM-ZZ-M3-N-0001.rvt - #3D - Workset - Fire\n\n1 clash between Pipe Types [8764935] in SPS-BSE-PRM-ZZ-M3-N-0001.rvt - #3D - Workset - Hydraulic and SPS-BSE-PRM-ZZ-M3-N-0001.rvt - #3D - Workset - Fire\n\n2 clashes between Pipe Types [8765682] in SPS-BSE-PRM-ZZ-M3-N-0001.rvt - #3D - Workset - Hydraulic and SPS-BSE-PRM-ZZ-M3-N-0001.rvt - #3D - Workset - Fire\n\n2 clashes between Pipe Types [8765731] in SPS-BSE-PRM-ZZ-M3-N-0001.rvt - #3D - Workset - Hydraulic and SPS-BSE-PRM-ZZ-M3-N-0001.rvt - #3D - Workset - Fire', '74edde3c-aced-4f9b-bfc6-d5019bcf7b65', 'd875dcfe-f36e-4fe9-89e2-3785a8ed373c', 'closed', 'U466RCJNQ2CZ', 'user', datetime.datetime(2024, 4, 15, 0, 0), None, None, 'urn:adsk.wipprod:dm.lineage:ZzWmrPZDQIy_gA1Q98VwLw', 'A7T2C667MYFWBP7D', '80a060d3-4647-4352-bd1d-ca93ff4985bc', '369f1b01-8c1a-445f-a5f3-85b1adbb9a14', None, None, None, 'A7T2C667MYFWBP7D', '2024-03-12 04:33:31.88', 'A7T2C667MYFWBP7D', '2024-04-24 03:35:39.934', 'A7T2C667MYFWBP7D', '2024-03-12 04:33:31.887', 'A7T2C667MYFWBP7D', '2024-04-26 05:37:51.794', datetime.datetime(2024, 3, 15, 0, 0), None, 'urn:adsk.objects:os.object:wip.dm.prod/fd1c174a-8b80-44ee-8d9c-d243f9e0e603.jpg', 1, None, None)
[2025-06-11 14:29:21] [DONE] Processed issues_issues in 0.3s
[2025-06-11 14:29:21] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\issues_root_cause_categories.csv → staging.issues_root_cause_categories ...
[2025-06-11 14:29:21] [DEBUG] First insert into staging.issues_root_cause_categories: ('78284b01-4b2a-42aa-a7b7-32100c3a1136', None, None, 'Commissioning', 1, 'System', '2018-12-06 08:25:17.653', 'System', '2018-12-09 09:43:32.047', 'System', '2018-12-09 09:43:32.051', 1)
[2025-06-11 14:29:21] [DONE] Processed issues_root_cause_categories in 0.05s
[2025-06-11 14:29:21] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\issues_root_causes.csv → staging.issues_root_causes ...
[2025-06-11 14:29:21] [DEBUG] First insert into staging.issues_root_causes: ('08afdebc-35fb-4cf4-9c3e-521906250108', None, None, '93d1b9cb-deb0-4166-9a48-5f0227feaacb', 'Human - Human error', 1, 'System', '2018-12-06 08:25:18.028', '8P9VK3RMFR2M', '2021-03-29 15:28:56.049', None, None, 1)
[2025-06-11 14:29:21] [SQL ERROR] in merge_issues_root_causes.sql: ('23000', "[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Violation of PRIMARY KEY constraint 'PK_issues_root_causes'. Cannot insert duplicate key in object 'dbo.issues_root_causes'. The duplicate key value is (e6bbede9-c08d-44d7-8f3b-0610c18932a3). (2627) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)")
-- MERGE for issues_root_causes
WITH src_deduped AS (
    SELECT *, ROW_NUMBER() OVER (
        PARTITION BY root_cause_id, bim360_account_id, bim360_project_id
        ORDER BY updated_at DESC
    ) AS rn
    FROM staging.issues_root_causes
)
MERGE INTO dbo.issues_root_causes AS tgt
USING (SELECT * FROM src_deduped WHERE rn = 1) AS src
ON tgt.root_cause_id = src.root_cause_id
   AND tgt.bim360_account_id = src.bim360_account_id
   AND tgt.bim360_project_id = src.bim360_project_id
WHEN MATCHED THEN
    UPDATE SET
        tgt.title = src.title,
        tgt.root_cause_category_id = src.root_cause_category_id,
        tgt.is_active = src.is_active,
        tgt.is_system = src.is_system,
        tgt.created_by = src.created_by,
        tgt.created_at = src.created_at,
        tgt.updated_by = src.updated_by,
        tgt.updated_at = src.updated_at,
        tgt.deleted_by = src.deleted_by,
        tgt.deleted_at = src.deleted_at
WHEN NOT MATCHED BY TARGET THEN
    INSERT (
        root_cause_id, bim360_account_id, bim360_project_id,
        root_cause_category_id, title, is_active, is_system,
        created_by, created_at, updated_by, updated_at,
        deleted_by, deleted_at
    )
    VALUES (
        src.root_cause_id, src.bim360_account_id, src.bim360_project_id,
        src.root_cause_category_id, src.title, src.is_active, src.is_system,
        src.created_by, src.created_at, src.updated_by, src.updated_at,
        src.deleted_by, src.deleted_at
    );
[2025-06-11 14:29:21] [DONE] Processed issues_root_causes in 0.07s
[2025-06-11 14:29:21] [SKIP] issuesbim360_attachments: missing merge SQL
[2025-06-11 14:29:21] [SKIP] issuesbim360_checklist_mappings: missing merge SQL
[2025-06-11 14:29:21] [SKIP] issuesbim360_comments: missing merge SQL
[2025-06-11 14:29:21] [SKIP] issuesbim360_custom_attribute_list_values: missing merge SQL
[2025-06-11 14:29:21] [SKIP] issuesbim360_custom_attributes: missing merge SQL
[2025-06-11 14:29:21] [SKIP] issuesbim360_custom_attributes_mappings: missing merge SQL
[2025-06-11 14:29:21] [SKIP] issuesbim360_issue_subtypes: missing merge SQL
[2025-06-11 14:29:21] [SKIP] issuesbim360_issue_types: missing merge SQL
[2025-06-11 14:29:21] [SKIP] issuesbim360_issues: missing merge SQL
[2025-06-11 14:29:21] [SKIP] issuesbim360_root_cause_categories: missing merge SQL
[2025-06-11 14:29:21] [SKIP] issuesbim360_root_causes: missing merge SQL
[2025-06-11 14:29:21] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\locations_nodes.csv → staging.locations_nodes ...
[2025-06-11 14:29:21] [DEBUG] First insert into staging.locations_nodes: ('25770f87-d4c0-41f3-964d-62f2838405f5', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', None, '62415c4c-93eb-4213-9e17-1b18bfc95bdf', 'Project', 0, '2023-03-06 21:30:24.403', '2023-03-06 21:30:24.403')
[2025-06-11 14:29:21] [FAIL] C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\locations_nodes.csv import failed: ('String data, right truncation: length 52 buffer 46', 'HY000')
[2025-06-11 14:29:21] [DONE] Processed locations_nodes in 0.05s
[2025-06-11 14:29:21] Importing C:/Users/RicoStrinati/iimbe/D2_252323_Nirimba_Fields_&_Schofields_PS - Documents/Delivery/03_Dashboard/06_ACCData/SPS/autodesk_data_extract_250611\locations_trees.csv → staging.locations_trees ...
[2025-06-11 14:29:21] [DEBUG] First insert into staging.locations_trees: ('25770f87-d4c0-41f3-964d-62f2838405f5', '7a870e2e-a4c3-4733-988b-7d7680564de6', 'e8c6b4fd-6e47-4d9c-815f-f871c5b30da7', 'Default', '2023-03-06 21:30:24.401', '2023-03-06 21:30:24.401')
[2025-06-11 14:29:21] [DONE] Processed locations_trees in 0.05s
[2025-06-11 14:29:21] [SKIP] metadata: missing merge SQL
[2025-06-11 14:29:21] [SKIP] relationships_entity_relationship: missing merge SQL
[2025-06-11 14:29:21] Skipped table summary:
[2025-06-11 14:29:21]  - activities_admin_activities: missing merge SQL
[2025-06-11 14:29:21]  - activities_assets_activities: missing merge SQL
[2025-06-11 14:29:21]  - activities_bridge_activities: missing merge SQL
[2025-06-11 14:29:21]  - activities_cost_activities: missing merge SQL
[2025-06-11 14:29:21]  - activities_cost_changes: missing merge SQL
[2025-06-11 14:29:22]  - activities_docs_activities: missing merge SQL
[2025-06-11 14:29:22]  - activities_docs_custom_attribute_constraints: missing merge SQL
[2025-06-11 14:29:22]  - activities_docs_custom_attributes: missing merge SQL
[2025-06-11 14:29:22]  - activities_docs_naming_standards: missing merge SQL
[2025-06-11 14:29:22]  - activities_docs_permissions: missing merge SQL
[2025-06-11 14:29:22]  - activities_docs_standard_attributes: missing merge SQL
[2025-06-11 14:29:22]  - activities_issues_activities: missing merge SQL
[2025-06-11 14:29:22]  - activities_issues_changes: missing merge SQL
[2025-06-11 14:29:22]  - activities_rfis_activities: missing merge SQL
[2025-06-11 14:29:22]  - activities_rfis_changes: missing merge SQL
[2025-06-11 14:29:22]  - activities_sheets_activities: missing merge SQL
[2025-06-11 14:29:22]  - activities_submittals_activities: missing merge SQL
[2025-06-11 14:29:22]  - activities_submittals_object_ball_in_court_companies: missing merge SQL
[2025-06-11 14:29:22]  - activities_submittals_object_ball_in_court_roles: missing merge SQL
[2025-06-11 14:29:22]  - activities_submittals_object_ball_in_court_users: missing merge SQL
[2025-06-11 14:29:22]  - activities_submittals_target_ball_in_court_companies: missing merge SQL
[2025-06-11 14:29:22]  - activities_submittals_target_ball_in_court_roles: missing merge SQL
[2025-06-11 14:29:22]  - activities_submittals_target_ball_in_court_users: missing merge SQL
[2025-06-11 14:29:22]  - activities_submittals_target_steps: missing merge SQL
[2025-06-11 14:29:22]  - activities_submittals_target_tasks: missing merge SQL
[2025-06-11 14:29:22]  - activities_submittals_target_transition_attachments: missing merge SQL
[2025-06-11 14:29:22]  - activities_submittals_target_watchers: missing merge SQL
[2025-06-11 14:29:22]  - admin_account_services: missing merge SQL
[2025-06-11 14:29:22]  - admin_accounts: missing merge SQL
[2025-06-11 14:29:22]  - admin_business_units: missing merge SQL
[2025-06-11 14:29:22]  - issuesbim360_attachments: missing merge SQL
[2025-06-11 14:29:22]  - issuesbim360_checklist_mappings: missing merge SQL
[2025-06-11 14:29:22]  - issuesbim360_comments: missing merge SQL
[2025-06-11 14:29:22]  - issuesbim360_custom_attribute_list_values: missing merge SQL
[2025-06-11 14:29:22]  - issuesbim360_custom_attributes: missing merge SQL
[2025-06-11 14:29:22]  - issuesbim360_custom_attributes_mappings: missing merge SQL
[2025-06-11 14:29:22]  - issuesbim360_issue_subtypes: missing merge SQL
[2025-06-11 14:29:22]  - issuesbim360_issue_types: missing merge SQL
[2025-06-11 14:29:22]  - issuesbim360_issues: missing merge SQL
[2025-06-11 14:29:22]  - issuesbim360_root_cause_categories: missing merge SQL
[2025-06-11 14:29:22]  - issuesbim360_root_causes: missing merge SQL
[2025-06-11 14:29:22]  - metadata: missing merge SQL
[2025-06-11 14:29:22]  - relationships_entity_relationship: missing merge SQL
